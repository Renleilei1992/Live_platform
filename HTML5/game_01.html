<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Game_01</title>
  </head>
  <body>
      <canvas id="id-canvas" width="400" height="300"></canvas>
      <style media="screen">
          canvas {
            border: 1px black solid;
            border-width: medium;
          }
      </style>
<script>

var log = console.log.bind(console)
var canvas = document.querySelector('#id-canvas')
var context = canvas.getContext('2d')

var x = 100
var y = 200
var speed = 5

var img = new Image()
img.src = 'block.png'
log(img)
//加载图片
img.onload = function(){
  context.drawImage(img, x, y)
}

var leftDown = false
var rightDown = false
// keydown events 按下键盘的键
window.addEventListener('keydown', function(event){
    log('keydown')
    var k = event.key
    //Log(event)
    if (k == 'a'){
        leftDown = true
//        x -= 10
//        context.clearRect(0, 0, canvas.width, canvas.height)
//        context.drawImage(img, x, y)
    }else if (k == 'd'){
        rightDown = true
//        x += 10
//        context.clearRect(0, 0, canvas.width, canvas.height)
//        context.drawImage(img, x, y)
    }
})

// keyup events 松开键盘的键
window.addEventListener('keyup', function(event){
    log('keyup')
    var k = event.key
    // Log(event)
    if (k == 'a'){
        leftDown = false
    } else if (k == 'd'){
        rightDown = false
    }
})

//设置定时器
setInterval(function(){
    // update x
    if (leftDown){
        x -= speed
    } else if (rightDown) {
        x += speed
    }
    // draw
    context.clearRect(0, 0, canvas.width, canvas.height)
    context.drawImage(img, x, y)
}, 1000/30)

</script>
  </body>
</html>

